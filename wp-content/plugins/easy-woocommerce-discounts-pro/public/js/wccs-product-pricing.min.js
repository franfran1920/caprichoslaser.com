!function(s){"use strict";function i(){this.init=this.init.bind(this),this.onFoundVariation=this.onFoundVariation.bind(this),this.onHideVariation=this.onHideVariation.bind(this),this.listeners=this.listeners.bind(this),this.delayLivePricing=this.delayLivePricing.bind(this),this.livePricing=this.livePricing.bind(this),this.countDownTimer=this.countDownTimer.bind(this),this.stopCountdownTimer=this.stopCountdownTimer.bind(this),this.init()}i.prototype.init=function(){s(".variations_form").length&&(this.$bulkTables=s(".wccs-bulk-pricing-table-container"),this.$bulkTitles=s(".wccs-bulk-pricing-table-title"),this.$parentTable=this.$bulkTables.not("[data-variation]"),this.$parentTableTitle=this.$bulkTitles.not("[data-variation]"),this.$messages=s(".wccs-purchase-message, .wccs-shortcode-purchase-message"),this.$parentMessage=this.$messages.not("[data-variation]"),this.$variationForm=s(".variations_form").first(),s(document.body).on("found_variation.wccs_product_pricing",this.$variationForm,this.onFoundVariation),s(document.body).on("hide_variation.wccs_product_pricing",this.$variationForm,this.onHideVariation)),this.$cartForm=s(".product form.cart"),this.$livePriceContainer=s(".wccs-live-price-container"),this.$countdownTimer=s(".wccs-countdown-timer-container"),this.$variationForm||this.delayLivePricing(500),this.listeners()},i.prototype.listeners=function(){var i=this;this.$cartForm.on("change keyup","input, .qty",function(){"variation_id"!==s(this).attr("name")&&i.delayLivePricing(500)}),wccs_product_pricing_params.set_min_quantity&&1==wccs_product_pricing_params.set_min_quantity&&this.$cartForm.on("change","input.qty",function(){var i=s(this).attr("min");null!=i&&""!==i&&!1!==i&&parseFloat(s(this).val())<parseFloat(i)&&s(this).val(i);i=s(this).attr("max");null!=i&&""!==i&&!1!==i&&parseFloat(s(this).val())>parseFloat(i)&&s(this).val(i)}),this.$cartForm.on("woocommerce-product-addons-update.wccs_product_pricing",function(){i.delayLivePricing(500)})},i.prototype.onFoundVariation=function(i,t){this.$bulkTables.length&&(this.$bulkTables.hide(),this.$bulkTitles.hide(),this.$bulkTables.filter('[data-variation="'+t.variation_id+'"]').length?(this.$bulkTables.filter('[data-variation="'+t.variation_id+'"]').show(),this.$bulkTitles.filter('[data-variation="'+t.variation_id+'"]').show()):this.$parentTable.length&&(this.$parentTable.show(),this.$parentTableTitle.show())),this.$messages.length&&(this.$messages.hide(),this.$messages.filter('[data-variation="'+t.variation_id+'"]').length?this.$messages.filter('[data-variation="'+t.variation_id+'"]').show():this.$parentMessage.length&&this.$parentMessage.show()),this.delayLivePricing(500)},i.prototype.onHideVariation=function(i){this.$bulkTables.length&&(this.$bulkTables.hide(),this.$bulkTitles.hide(),this.$parentTable.length&&(this.$parentTable.show(),this.$parentTableTitle.show())),this.$messages.length&&(this.$messages.hide(),this.$parentMessage.length&&this.$parentMessage.show())},i.prototype.delayLivePricing=function(i){if(!i)return this.livePricing();this.delayedLivePricing&&clearTimeout(this.delayedLivePricing),this.delayedLivePricing=setTimeout(this.livePricing,i)},i.prototype.livePricing=function(){var i,n,t,c;(wccs_product_pricing_params.display_live_price&&1==wccs_product_pricing_params.display_live_price||wccs_product_pricing_params.display_live_total_price&&1==wccs_product_pricing_params.display_live_total_price||wccs_product_pricing_params.display_countdown_timer&&0!=wccs_product_pricing_params.display_countdown_timer)&&this.$cartForm.length&&(this.$livePriceContainer=this.$livePriceContainer.length?this.$livePriceContainer:s(".wccs-live-price-container"),this.$countdownTimer=this.$countdownTimer.length?this.$countdownTimer:s(".wccs-countdown-timer-container"),(this.$livePriceContainer.length||this.$countdownTimer.length)&&(this.livePriceRunning?this.delayLivePricing(500):(t="",wccs_product_pricing_params.display_live_price&&1==wccs_product_pricing_params.display_live_price&&(s(".wccs-live-price",this.$livePriceContainer).length||(t+='<div class="wccs-live-price-section wccs-live-price-price-section">',t+=wccs_product_pricing_params.live_pricing_label?"<span>"+wccs_product_pricing_params.live_pricing_label+":</span> ":"",t+='<span class="wccs-live-price price"></span>',t+="</div>")),wccs_product_pricing_params.display_live_total_price&&1==wccs_product_pricing_params.display_live_total_price&&(s(".wccs-live-total-price",this.$livePriceContainer).length||(t+='<div class="wccs-live-price-section wccs-live-price-total-price-section">',t+=wccs_product_pricing_params.live_pricing_total_label?"<span>"+wccs_product_pricing_params.live_pricing_total_label+":</span> ":"",t+='<span class="wccs-live-total-price price"></span>',t+="</div>")),t.length&&this.$livePriceContainer.html(t),s(".wccs-live-price, .wccs-live-total-price",this.$livePriceContainer).html(""),i=0,n=setInterval(function(){0==i++%5?s(".wccs-live-price, .wccs-live-total-price",this.$livePriceContainer).html("."):s(".wccs-live-price, .wccs-live-total-price",this.$livePriceContainer).append(".")},250),this.livePriceRunning=!0,t=this.$cartForm.serialize(),c=this,/add-to-cart=/gi.test(t)||(t+="&add-to-cart="+wccs_product_pricing_params.product_id),s.ajax({url:wccs_product_pricing_params.ajaxurl,type:"POST",dataType:"json",data:{action:"wccs_live_price",nonce:wccs_product_pricing_params.nonce,data:t}}).done(function(i){if(clearInterval(n),i&&1==i.success&&i.data){if(wccs_product_pricing_params.display_live_price&&1==wccs_product_pricing_params.display_live_price)if(!1!==i.data.price){var t="";if(i.data.prices_quantities){var e,a=0;for(e in i.data.prices_quantities)t+='<div class="wccs-live-price-qty"><span class="wccs-live-price-qty-price">'+e+'</span> <span class="wccs-live-price-qty-quantity"> &times; '+i.data.prices_quantities[e]+"</span></div>",++a;1==a&&e?t=e:(t=t.length?'<div class="wccs-live-price-qty-container">'+t+"</div>":"").length&&i.data.prices_quantities_sum&&(t+='<div class="wccs-live-price-qty-total"><span>'+i.data.prices_quantities_sum+"</span></div>")}s(".wccs-live-price",c.$livePriceContainer).html(t.length?t:i.data.price)}else null!==i.data.main_price&&"always"===wccs_product_pricing_params.live_price_display_type&&s(".wccs-live-price",c.$livePriceContainer).html(i.data.main_price);wccs_product_pricing_params.display_live_total_price&&1==wccs_product_pricing_params.display_live_total_price&&(!1!==i.data.price?s(".wccs-live-total-price",c.$livePriceContainer).html(i.data.total_price):null!=i.data.main_total_price&&"always"===wccs_product_pricing_params.live_price_display_type&&s(".wccs-live-total-price",c.$livePriceContainer).html(i.data.main_total_price)),wccs_product_pricing_params.display_countdown_timer&&0!=wccs_product_pricing_params.display_countdown_timer&&(i.data.remaining_time?c.countDownTimer(i.data.remaining_time):c.stopCountdownTimer()),!1!==i.data.price||null!=i.data.main_price&&"always"===wccs_product_pricing_params.live_price_display_type?c.$livePriceContainer.slideDown():c.$livePriceContainer.slideUp().html("")}else c.stopCountdownTimer(),c.$livePriceContainer.slideUp().html("")}).fail(function(){c.stopCountdownTimer(),c.$livePriceContainer.slideUp().html("")}).always(function(){c.livePriceRunning=!1,clearInterval(n)}))))},i.prototype.countDownTimer=function(i){this.flipDown?(!1===this.flipDown.remainingTime||i<this.flipDown.remainingTime)&&this.flipDown.updateTime({type:"remainingTime",value:i-1}):(this.$countdownTimer.slideDown(),this.flipDown=new FlipDown({type:"remainingTime",value:i-1},"wccs-countdown-timer-content",{headingPosition:"bottom",daysLabel:wccs_product_pricing_params.countdown_timer_days,hoursLabel:wccs_product_pricing_params.countdown_timer_hours,minutesLabel:wccs_product_pricing_params.countdown_timer_minutes,secondsLabel:wccs_product_pricing_params.countdown_timer_seconds}).start())},i.prototype.stopCountdownTimer=function(){this.flipDown&&(this.flipDown.stop(),this.flipDown=!1,this.$countdownTimer.slideUp().html(""))};var t,e={getInstance:function(){return t=t||new i}};s.fn.wccs_get_product_pricing=function(){return e.getInstance()},s(function(){s().wccs_get_product_pricing()})}(jQuery);